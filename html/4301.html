<meta http-equiv="content-type" content="text/html; charset=UTF-8"><html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="include/hoj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<center>
<div style="width:90%; text-align:left">
<img src="image/image_logo_png"/>
</div>
<table width="96%">
<tr align="center" class="hd" valign="top">
<th><a href="faqs.php">F.A.Qs</a></th>
<th><a href="./">Home</a></th>
<th><a href="./bbs.php">Discuss</a></th>
<th><a href="./problemset.php">ProblemSet</a></th>
<th><a href="./status.php">Status</a></th>
<th><a href="./ranklist.php">Ranklist</a></th>
<th><a href="./contest.php">Contest</a></th>
<th><a href="./modifypage.php"><b>ModifyUser</b></a>  <a href="userinfo.php?user=free_bzoj">
<font color="red">free_bzoj</font></a></th><th><a href="logout.php">Logout</a></th> <th><a href="./donation.php"><font color="red">捐赠本站</font></a></th>
</tr>
</table>
</center>
<center>
<div class="notice">
<div>
<b>Notice:</b>1:由于本OJ建立在Linux平台下，而许多题的数据在Windows下制作，请注意输入、输出语句及数据类型及范围，避免无谓的RE出现。
2:本站即将推出针对初学者的试题系统(与目前OJ是分开的，互不影响)，内容覆盖从语法入门到NOI的所有知识点，敬请关注。
	</div>
</div>
</center>
<title>Problem 4301. -- HDU 5300 Angry Trees</title><center><h2>4301: HDU 5300 Angry Trees</h2><span class="green">Time Limit: </span>12 Sec  <span class="green">Memory Limit: </span>256 MB<br/><span class="green">Submit: </span>3  <span class="green">Solved: </span>0<br/>[<a href="submitpage.php?id=4301">Submit</a>][<a href="problemstatus.php?id=4301">Status</a>][<a href="bbs.php?id=4301">Discuss</a>]</center><h2>Description</h2><div class="content"><div>JRY is so rich that he bought too many trees and planted them in his yard. Because of his personal preference, all these trees have the same shape. At first, these trees were small and peaceful, but after growing for several years, they become huge and compete for the limited water and nutrition. Therefore, they become angry, and their common enemy is JRY, because it is JRY who planted them in such a "small" place (although his yard is the biggest in the world). </div>
<div></div>
<div>There are m angry trees, and each angry tree has n nodes and n−1 branches. All the angry trees decide to combine together, and they made extra m−1 branches so that they can be one. Moreover, they select the first node of the first tree to be the root of the whole huge tree. Now, there is a terribly enormous tree with nm nodes and nm−1 branches. </div>
<div></div>
<div>The trees come up with an idea to revenge. When JRY is sleeping, they drag JRY onto one of the nodes, and steal all JRY's money and put it onto one node too (the two nodes can be either same or different). When JRY wakes up, he definitely will go for these money. Every time JRY moves down along a branch (moving towards the root), he will spend 1 unit time, and when he moves up along a branch (moving away from the root), he will spend 2 unit time. Additionally, smart JRY will always move along the shortest path on the tree between him and his money. </div>
<div></div>
<div>One nightmare of the trees is to find the longest time that JRY need to find his money, and they also need to know how many different ways there are to get this longest time (two ways are considered different if and only if JRY's initial position is different or the money's position is different). Can you help them?</div>
<p></p></div><h2>Input</h2><div class="content"><div>The first line of the input is a single integer T, indicating the number of testcases. </div>
<div>For each testcase, the first line is two integers n and m (1n,m50000). Each of the next n−1 lines contains two integers x and y, which represent one branch (x,y) in every tree. Each of the following m−1 lines contains four integers x,a,y,b, which means there is an additional branch connecting the a-th node of the x-th tree and the b-th node of the y-th tree. It is guaranteed that either every small tree or the whole tree is an acyclic connected undirected graph. Please be aware that the first node (the node numbered 1) of the first tree (the tree numbered 1) is the root of the whole tree. </div>
<div>It is guaranteed that for all the testcases, Siga(n)+Sigma(m)&lt;=1000000.</div>
<p></p></div><h2>Output</h2><div class="content"><div>For each testcase, print two space-separated integers indicating the longest time JRY need to find his money and the ways of position to reach this upper bound.</div>
<p></p></div><h2>Sample Input</h2>
<div class="content"><span class="sampledata">2<br/>
3 3<br/>
3 1<br/>
2 1<br/>
3 1 2 2<br/>
1 3 2 1<br/>
3 8<br/>
3 1<br/>
2 3<br/>
4 3 3 1<br/>
3 1 2 3<br/>
6 2 1 3<br/>
8 3 7 3<br/>
5 3 7 3<br/>
6 3 7 2<br/>
8 3 2 2</span></div><h2>Sample Output</h2>
<div class="content"><span class="sampledata">11 2<br/>
22 3<br/>
</span></div><h2>HINT</h2>
<div class="content"><p></p></div><h2>Source</h2>
<div class="content"><p><a href="problemset.php?search="></a></p></div><center>[<a href="submitpage.php?id=4301">Submit</a>][<a href="problemstatus.php?id=4301">Status</a>][<a href="bbs.php?id=4301">Discuss</a>]</center>﻿<br/>
<a href="./"><span class="red">HOME</span></a>
<a href="javascript:history.go(-1)"><span class="red">Back</span></a>
<hr/>
<center>
<div class="footer">
<a href="setlang.php?lang=ko">한국어</a> 
		<a href="setlang.php?lang=cn">中文</a> 
		<a href="setlang.php?lang=fa">فارسی</a> 
		<a href="setlang.php?lang=en">English</a> 
		<a href="setlang.php?lang=th">ไทย</a>
<br/> <div>版权所有 ©2008-2012 大视野在线测评 | <a href="http://www.miitbeian.gov.cn">湘ICP备13009380号</a> | <script language="JavaScript" src="http://s21.cnzz.com/stat.php?id=2982771&amp;web_id=2982771"></script>
</div>
<div>Based on opensource project <a href="http://hustoj.googlecode.com">hustoj</a>.</div>
</div>
</center>
</body>
</html>
